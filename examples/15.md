
https://users.rust-lang.org/t/impl-trait-for-struct-with-lifetime-parameter/52475


COMPILE

```rust
pub trait Key<'a> {
    fn from_u8(key: &'a [u8]) -> Self;
    fn as_slice<T, F: Fn(&[u8]) -> T>(&self, f: F) -> T;
}

pub fn from_u8<'a, K: Key<'a>>(key: &'a [u8]) -> K {
    Key::<'a>::from_u8(key)
}

struct MyKey<'a>(&'a [u8]);

impl<'a> Key<'a> for MyKey<'a> {
    fn from_u8(key: &'a [u8]) -> Self {
        MyKey(key)
    }

    fn as_slice<T, F: Fn(&[u8]) -> T>(&self, f: F) -> T {
        f(&self.0)
    }
}

fn main() {}
```



COMPILE ERROR!

```rust
pub trait Key {
    fn from_u8(key: &[u8]) -> Self;
    fn as_slice<T, F: Fn(&[u8]) -> T>(&self, f: F) -> T;
}

pub fn from_u8<K: Key>(key: &[u8]) -> K {
    Key::from_u8(key)
}

struct MyKey<'a>(&'a [u8]);

impl Key for MyKey<'_> {
    fn from_u8(key: &[u8]) -> Self {
        MyKey(key)
    }

    fn as_slice<T, F: Fn(&[u8]) -> T>(&self, f: F) -> T {
        f(&self.0)
    }
}

fn main(){}
```


```
If the trait is from outter crate, it can't be changed, is there any way to pass the compiling?
```

```rust
pub trait Key {
    fn from_u8(key: &[u8]) -> Self;
    fn as_slice<T, F: Fn(&[u8]) -> T>(&self, f: F) -> T;
}

pub fn from_u8<K: Key>(key: &[u8]) -> K {
    Key::from_u8(key)
}

struct MyKey(Vec<u8>);

impl Key for MyKey {
    fn from_u8(key: &[u8]) -> Self {
        MyKey(key.into())
    }

    fn as_slice<T, F: Fn(&[u8]) -> T>(&self, f: F) -> T {
        f(&self.0[..])
    }
}

fn main() {}
```